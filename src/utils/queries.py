data_query_order_line = '''
        WITH
        entries as
        (   select
                regexp_replace("SOURCE NO_", '[A-Z]') AS "customerCode",
                "ITEM LEDGER ENTRY NO_" as "itemLedgerEntryNo",
                "EXTERNAL DOCUMENT NO_" AS "externalDocumentNo",
                "ITEM NO_" AS "itemCode",
                "DESCRIPTION" as "itemDescription",
                "LOCATION CODE" as "locationCode",
                "O ITEM LEDGER ENTRY QUANTITY"*-1 as "invoiceQuantity",
                "O SALES AMOUNT" as "saleValue",
                "O COST AMOUNT" as "costValue",
                MIN("O DOCUMENT DATE") OVER (PARTITION BY "EXTERNAL DOCUMENT NO_") as "invoiceDate"
            from buygro.ads.adj_vle
            where --"O DOCUMENT DATE" = '2024-04-03' --CURRENT_DATE()
                "O POSTING DATE" <= '2024-05-12' and
        "EXTERNAL DOCUMENT NO_" in ('20369948',	'20369821',	'20369824',	'20369825',	'20369828',	'20369832',	'20369833',	'20369835',	'20369837',	'20369838',
            	'20369843',	'20369846',	'20370133',	'20370135',	'20369853',	'20369855',	'20369859',	'20369861',	'20369864',	'20369865',	'20369866',	
                '20369871',	'20369874',	'20369877',	'20369880',	'20369883',	'20369885',	'20369887',	'20369889',	'20369891',	'20369893',	'20369894',	
                '20369895',	'20369896',	'20369897',	'20369898',	'20369899',	'20369900',	'20369901',	'20369902',	'20369904',	'20369907',	'20369912',	
                '20369914',	'20369915',	'20369916',	'20369917',	'20369918',	'20369919',	'20369920',	'20369921',	'20369922',	'20369924',	'20369926',	
                '20369927',	'20369929',	'20369932',	'20369934',	'20369936',	'20369937',	'20369938',	'20369939',	'20369940',	'20369941',	'20369942',	
                '20369945',	'20369946',	'20369950',	'20369955',	'20369958',	'20369959',	'20369960',	'20369961',	'20369962',	'20369963',	'20369964',	
                '20369965',	'20369967',	'20369968',	'20369969',	'20369974',	'20369979',	'20369981',	'20369984',	'20369985',	'20369986',	'20369987',	
                '20369988',	'20369989',	'20369990',	'20369991',	'20369992',	'20369993',	'20369994',	'20369995',	'20369996',	'20369997',	'20370000',	
                '20370001',	'20370002',	'20370003',	'20370004',	'20370005',	'20370006',	'20370007',	'20370008',	'20370009',	'20370011',	'20370012',	
                '20370013',	'20370014',	'20370015',	'20370016',	'20370019',	'20370020',	'20370021',	'20370022',	'20370023',	'20370024',	'20370025',	
                '20370026',	'20370027',	'20370028',	'20370029',	'20370030',	'20370031',	'20370032',	'20370033',	'20370047',	'20370048',	'20370049',	
                '20370050',	'20370051',	'20370052',	'20370053',	'20370054',	'20370055',	'20370056',	'20370057',	'20370058',	'20370059',	'20370060',	
                '20370061',	'20370062',	'20370063',	'20370064',	'20370065',	'20370066',	'20370067',	'20370068',	'20370069',	'20370070',	'20370071',	                
                '20370072',	'20370073',	'20370074',	'20370075',	'20370076',	'20370077',	'20370078',	'20370079',	'20370080',	'20370082',	'20370083',	
                '20370085',	'20370086',	'20370087',	'20370089',	'20370093',	'20370098',	'20370100',	'20370103',	'20370105',	'20370107',	'20370108',	
                '20370110',	'20370117',	'20370118',	'20370119',	'20370121',	'20370122',	'20370123',	'20370127',	'20370137',	'20370138',	'20369873',	
                '20370140',	'20369966',	'20370142',	'20370143',	'20370144',	'20370145',	'20370146',	'20370147',	'20370148',	'20370149',	'20370150',	
                '20370157',	'20370158',	'20370159',	'20370160',	'20370162',	'20370165',	'20370166',	'20370167',	'20370169',	'20370171',	'20370177',	
                '20370179',	'20370180',	'20370183',	'20370187',	'20370194',	'20370208',	'20370209',	'20370210',	'20370211',	'20370212',	'20370213',	
                '20370214',	'20370215',	'20370216',	'20370217',	'20370218',	'20370219',	'20370221',	'20370223',	'20370224',	'20370225',	'20370226',	
                '20370227',	'20370228',	'20370229',	'20370230',	'20370231',	'20370232',	'20370222',	'20370234',	'20370235',	'20370238',	'20370239',	
                '20370240',	'20370241',	'20370242',	'20370243',	'20370244',	'20370245',	'20370246',	'20370247',	'20370248',	'20370249',	'20370250',	
                '20370251',	'20370252',	'20370254',	'20370255',	'20370256',	'20370257',	'20370258',	'20370259',	'20370260',	'20370261',	'20370262',	
                '20370263',	'20370264',	'20370266',	'20370267',	'20370268',	'20370269',	'20370270',	'20370271',	'20370272',	'20370273',	'20370274',	
                '20370275',	'20370276',	'20370277',	'20370278',	'20370279',	'20370280',	'20370281',	'20370282',	'20370283',	'20370284',	'20370285',	
                '20370286',	'20370287',	'20370288',	'20370289',	'20370290',	'20370292',	'20370293',	'20370294',	'20370296',	'20370297',	'20370298',	
                '20370299',	'20370300',	'20370301',	'20370302',	'20370303',	'20370304',	'20370305',	'20370306',	'20370307',	'20370308',	'20370309',	
                '20370310',	'20370311',	'20370312',	'20370314',	'20370315',	'20370316',	'20370317',	'20370318',	'20370319',	'20370320',	'20370321',	
                '20370322',	'20370323',	'20370324',	'20370325',	'20370326',	'20370327',	'20370328',	'20370329',	'20370330',	'20370331',	'20370332',
                '20370333',	'20370334',	'20370335',	'20370336',	'20370337',	'20370338',	'20370339',	'20370340',	'20370341',	'20370342',	'20370343',	
                '20370345',	'20370346',	'20370347',	'20370348',	'20370349',	'20370351',	'20370354',	'20370355',	'20370356',	'20370357',	'20370359',	
                '20370360',	'20370361',	'20370362',	'20370291',	'20370313',	'20370350',	'20370352',	'20370358',	'20370364',	'20370365',	'20370366',	
                '20370367',	'20370368',	'20370369',	'20370370',	'20370371',	'20370372',	'20370373',	'20370374',	'20370375',	'20370376',	'20370377',	
                '20370378',	'20370379',	'20370380',	'20370381',	'20370382',	'20370383',	'20370384',	'20370385',	'20370386',	'20370387',	'20370388',	
                '20370389',	'20370390',	'20370391',	'20370392',	'20370393',	'20370395',	'20370396',	'20370397',	'20370398',	'20370399',	'20370400',	
                '20370401',	'20370402',	'20370403',	'20370404',	'20370405',	'20370406',	'20370407',	'20370408',	'20370409',	'20370410',	'20370411',	
                '20370412',	'20370413',	'20370414',	'20370415',	'20370416',	'20370417',	'20370418',	'20370419',	'20370420',	'20370421',	'20370422',	
                '20370423',	'20370424',	'20370425',	'20370426',	'20370427',	'20370428',	'20370429',	'20370430',	'20370431',	'20370432',	'20370433',	
                '20370434',	'20370435',	'20370436',	'20370437',	'20370438',	'20370439',	'20370440',	'20370441',	'20370442',	'20370443',	'20370444',	
                '20370445',	'20370446',	'20370447',	'20370448',	'20370394',	'20370449',	'20370450',	'20370451',	'20370452',	'20370453',	'20370454',	
                '20370455',	'20370456',	'20370457',	'20370458',	'20370459',	'20370460',	'20370461',	'20370462',	'20370463',	'20370464',	'20370465',	
                '20370466',	'20370467',	'20370468',	'20370469',	'20370470',	'20370471',	'20370472',	'20370473',	'20370474',	'20370475',	'20370476',	
                '20370477',	'20370478',	'20370479',	'20370480',	'20370481',	'20370482',	'20370483',	'20370484',	'20370485',	'20370486',	'20370487',	
                '20370488',	'20370489',	'20370490',	'20370491',	'20370492',	'20370493',	'20370494',	'20370495',	'20370496',	'20370363',	'20370497',	
                '20370498',	'20370499',	'20370500',	'20370501',	'20370502',	'20370503',	'20370504',	'20370505',	'20370506',	'20370507',	'20370508',	'20370509',	'20370510',	'20370511',	'20370512',	'20370513',	'20370514',	'20370515',	'20370516',	'20370517',	'20370518',	'20370519',	'20370520',	'20370521',	'20370522',	'20370523',	'20370524',	'20370525',	'20370526',	'20370527',	'20370528',	'20370529',	'20370530',	'20370531',	'20370532',	'20370533',	'20370534',	'20370535',	'20370536',	'20370537',	'20370538',	'20370539',	'20370540',	'20370541',	'20369338',	'20369340',	'20369386',	'20369444',	'20369455',	'20369574',	'20369577',	'20369581',	'20369705',	'20369706',	'20369707',	'20369708',	'20369709',	'20369710',	'20369757',	'20369773',	'20369774',	'20368789',	'20368773',	'20369867',	'20369868',	'20369872',	'20369879',	'20369890',	'20369952',	'20370084',	'20370088',	'20370154',	'20370170')
        ),
        customer_details as
        (
            select distinct
                "ecvId",
                "erpId",
                "source",
                "name",
                replace(parse_json("details"):city, '"', '') as "city",
                replace(parse_json("details"):region, '"', '') as "region",
                replace(parse_json("details"):address, '"', '') as "address",
                parse_json("details"):location:lat as "lattitude",
                parse_json("details"):location:long as "longitude"
            from buygro.raw_ecv.bg_ecv_users
        ),
        item_details as
        (
            select
                item_code,
                description,
                min(physical_wt/physical_qty) as item_weight
            from BUYGRO.RAW.AFSYS_V_STK_DETAIL_WITH_DMG_DETAILS
            where customer = 'BUYGRO'
            and bin <> 'DESBIN'
            group by 1, 2
        )
        select ---top 2000
            b."name" as "customerName",
            b."source" as "customerSource",
            b."city" as "customerCity",
            b."region" as "customerRegion",
            b."address" as "customerAddress",
            b."lattitude" as "customerLat",
            b."longitude" as "customerLong",
            c.item_weight as "itemWeight",
            c.item_weight*"invoiceQuantity" as "itemTotalWeight",
            a.*
        from entries as a
        left join customer_details as b on a."customerCode" = b."ecvId"
        left join item_details as c on a."itemCode" = c.item_code

'''
data_query_item_weights = '''
    Select
        ITEM_CODE as "itemCode",
        --ifnull((Sum(BOOKED_WT) / Sum(BOOKED_QTY))::Int,0) As "itemWeight"
        1 as "itemWeight"
    From BUYGRO.RAW.AFSYS_V_STK_DETAIL_BUYGRO
    Where BOOKED_WT > 0
    Group by 1
'''